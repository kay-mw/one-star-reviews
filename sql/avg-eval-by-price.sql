SELECT
  CASE
    WHEN price < 10.00 THEN '0.00-9.99'
    WHEN price BETWEEN 10.00 AND 19.99 THEN '10.00-19.99'
    WHEN price BETWEEN 20.00 AND 29.99 THEN '20.00-29.99'
    WHEN price BETWEEN 30.00 AND 39.99 THEN '30.00-39.99'
    WHEN price BETWEEN 40.00 AND 49.99 THEN '40.00-49.99'
    WHEN price BETWEEN 50.00 AND 59.99 THEN '50.00-59.99'
    WHEN price BETWEEN 60.00 AND 69.99 THEN '60.00-69.99'
    WHEN price BETWEEN 70.00 AND 79.99 THEN '70.00-79.99'
    WHEN price BETWEEN 80.00 AND 89.99 THEN '80.00-89.99'
    WHEN price BETWEEN 90.00 AND 99.99 THEN '90.00-99.99'
    WHEN price BETWEEN 100.00 AND 119.99 THEN '100.00-119.99'
    WHEN price BETWEEN 120.00 AND 139.99 THEN '120.00-139.99'
    WHEN price BETWEEN 140.00 AND 159.99 THEN '140.00-159.99'
    WHEN price BETWEEN 160.00 AND 179.99 THEN '160.00-179.99'
    WHEN price BETWEEN 180.00 AND 199.99 THEN '180.00-199.99'
    WHEN price BETWEEN 200.00 AND 299.99 THEN '200.00-299.99'
    WHEN price BETWEEN 300.00 AND 399.99 THEN '300.00-399.99'
    WHEN price BETWEEN 400.00 AND 499.99 THEN '400.00-499.99'
    WHEN price BETWEEN 500.00 AND 999.99 THEN '500.00-999.99'
    WHEN price BETWEEN 1000.00 AND 1999.99 THEN '1000.00-1999.99'
    ELSE '2000.00-INFINITY'
  END AS price_category,
  AVG(evaluation) AS average_evaluation,
  COUNT(*) AS n_evaluations,
  STDDEV(evaluation) AS stddev_evaluation
FROM
  delta_scan('./export/main')
WHERE
  price IS NOT NULL
GROUP BY
  price_category
ORDER BY
  LEN(price_category),
  price_category
